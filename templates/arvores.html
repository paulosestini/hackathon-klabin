<!DOCTYPE html>

<head> 
    <title>Cresça sua Ideia</title>
    <link rel="stylesheet" href="{{url_for('static', filename='style.css')}}">
</head>
<body class="fundo">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <script type=text/javascript>
        $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    </script>


    {% if trees %}
        <div class="header"><h1>Cresça sua Ideia</h1></div>
        {% for tree in trees %}
        <li class="ideia">
            <p><div class="titulo">{{ tree.title }}</div></p>
            
            <script type=text/javascript>
                    $(function() {
                        $('input#vote{{tree.tree_id}}').bind('click', function(){
                            $.getJSON($SCRIPT_ROOT + '/votar/{{ tree.tree_id }}', {}, function(data){
                                $("#votes{{tree.tree_id}}").text(data.votes);
                                $("#stage{{tree.tree_id}}").attr('src', 'static/' + data.stage + '.png');
                            });
                            return false;
                        });
                    });
                </script>
                <div class="background">
                    <img id="stage{{tree.tree_id}}" src="static/{{tree.stage}}.png">
                    <p class="mensagem">{{ tree.message }}</p>
                    <p>Foi regada <span id="votes{{tree.tree_id}}">{{ tree.votes }}</span> vezes</p>
                    <input type="submit" href=# id=vote{{tree.tree_id}} value=Regar>
                </div>
            </li>
        {% endfor %}
    {% else %}
        <h1>Não há árvores plantadas</h1>
    {% endif %}
</body>